<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>295. Find Median from Data Stream - Leetbook</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Solutions</li><li class="chapter-item expanded "><div>Easy</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../easy-problems/1.html">1. Two Sum</a></li><li class="chapter-item expanded "><a href="../easy-problems/70.html">70. Climbing Stairs</a></li><li class="chapter-item expanded "><a href="../easy-problems/206.html">206. Reverse Linked Lists</a></li><li class="chapter-item expanded "><a href="../easy-problems/876.html">876.	Middle of the Linked List</a></li></ol></li><li class="chapter-item expanded "><div>Medium</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../medium-problems/3.html">3. Longest Substring Without Repeating Characters</a></li><li class="chapter-item expanded "><a href="../medium-problems/7.html">7. Reverse Integer</a></li><li class="chapter-item expanded "><a href="../medium-problems/78.html">78. Subsets</a></li><li class="chapter-item expanded "><a href="../medium-problems/151.html">151. Reverse Words in a String</a></li><li class="chapter-item expanded "><a href="../medium-problems/179.html">179. Largest Number</a></li><li class="chapter-item expanded "><a href="../medium-problems/322.html">322. Coin Change</a></li><li class="chapter-item expanded "><a href="../medium-problems/435.html">435. Non-overlapping Intervals</a></li><li class="chapter-item expanded "><a href="../medium-problems/2095.html">2095. Delete the Middle Node of a Linked List</a></li></ol></li><li class="chapter-item expanded "><div>Hard</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../hard-problems/60.html">60. Permutation Sequence</a></li><li class="chapter-item expanded "><a href="../hard-problems/65.html">65. Valid Number</a></li><li class="chapter-item expanded "><a href="../hard-problems/239.html">239. Sliding Window Maximum</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Solutions w/o explanation</li><li class="chapter-item expanded "><div>Easy</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../easy-problems-no-explain/20.html">20. Valid Parentheses</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/21.html">21. Merge Two Sorted Lists</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/111.html">111. Minimum Depth of Binary Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/112.html">112. Path Sum</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/118.html">118. Pascal's Triangle</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/125.html">125. Valid Palindrome</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/141.html">141. Linked List Cycle</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/191.html">191. Number of 1 Bits</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/217.html">217. Contains Duplicate</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/226.html">226. Invert Binary Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/292.html">292. Nim Game</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/344.html">344. Reverse String</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/374.html">374. Guess Number Higher or Lower</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/897.html">897. Increasing Order Search Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/1290.html">1290. Convert Binary Number in a Linked List to Integer</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/1822.html">1822. Sign of the Product of an Array</a></li><li class="chapter-item expanded "><a href="../easy-problems-no-explain/1929.html">1929. Concatenation of Array</a></li></ol></li><li class="chapter-item expanded "><div>Medium</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../medium-problems-no-explain/2.html">2. Add Two Numbers</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/17.html">17. Letter Combination of a Phone Number</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/19.html">19. Remove Nth Node From End of List</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/46.html">46. Permutations</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/98.html">98. Validate Binary Search Tree</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/113.html">113. Path Sum II</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/150.html">150. Evaluate Reverse Polish Notation</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/210.html">210. Course Schedule II</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/237.html">237. Delete Node in a Linked List</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/347.html">347. Top K Frequent Elements</a></li><li class="chapter-item expanded "><a href="../medium-problems-no-explain/371.html">371. Sum of Two Integers</a></li></ol></li><li class="chapter-item expanded "><div>Hard</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../hard-problems-no-explain/68.html">68. Text Justification</a></li><li class="chapter-item expanded "><a href="../hard-problems-no-explain/295.html" class="active">295. Find Median from Data Stream</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Leetbook</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="295-find-median-from-data-stream"><a class="header" href="#295-find-median-from-data-stream">295. Find Median from Data Stream</a></h1>
<h2 id="description-of-the-problem"><a class="header" href="#description-of-the-problem">Description of the Problem</a></h2>
<p>The <strong>median</strong> is the middle value in an ordered integer list. If the size of the list is even, there is no middle value, and the median is the mean of the two middle values.</p>
<p>For example, for <code>arr = [2,3,4]</code>, the median is <code>3</code>.
For example, for <code>arr = [2,3]</code>, the median is <code>(2 + 3) / 2 = 2.5</code>.
Implement the MedianFinder class:</p>
<p><code>MedianFinder()</code> initializes the <code>MedianFinder</code> object.
<code>void addNum(int num)</code> adds the integer <code>num</code> from the data stream to the data structure.
<code>double findMedian()</code> returns the median of all elements so far. Answers within \(10^{-5}\) of the actual answer will be accepted.</p>
<p><strong>Example 1:</strong></p>
<pre><code>Input
[&quot;MedianFinder&quot;, &quot;addNum&quot;, &quot;addNum&quot;, &quot;findMedian&quot;, &quot;addNum&quot;, &quot;findMedian&quot;]
[[], [1], [2], [], [3], []]
Output
[null, null, null, 1.5, null, 2.0]

Explanation
MedianFinder medianFinder = new MedianFinder();
medianFinder.addNum(1);    // arr = [1]
medianFinder.addNum(2);    // arr = [1, 2]
medianFinder.findMedian(); // return 1.5 (i.e., (1 + 2) / 2)
medianFinder.addNum(3);    // arr[1, 2, 3]
medianFinder.findMedian(); // return 2.0
</code></pre>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>-10^5 &lt;= num &lt;= 10^5</code></li>
<li>There will be at least one element in the data structure before calling findMedian.</li>
<li>At most <code>5 * 10^4</code> calls will be made to <code>addNum</code> and <code>findMedian</code>.</li>
</ul>
<p><strong>Follow up:</strong></p>
<ul>
<li>If all integer numbers from the stream are in the range <code>[0, 100]</code>, how would you optimize your solution?</li>
<li>If <code>99%</code> of all integer numbers from the stream are in the range <code>[0, 100]</code>, how would you optimize your solution?</li>
</ul>
<h2 id="solution"><a class="header" href="#solution">Solution</a></h2>
<h3 id="code-java"><a class="header" href="#code-java">Code (Java)</a></h3>
<pre><code class="language-Java">class MedianFinder {

    private final PriorityQueue&lt;Integer&gt; leftMaxHeap;
    private final PriorityQueue&lt;Integer&gt; rightMinHeap;

    public MedianFinder() {
        leftMaxHeap = new PriorityQueue&lt;Integer&gt;(Collections.reverseOrder());
        rightMinHeap = new PriorityQueue&lt;Integer&gt;();
    }
    
    public void addNum(int num) {
        Integer leftMax = leftMaxHeap.peek();
        if (leftMax != null &amp;&amp; num &lt;= leftMax){
            leftMaxHeap.add(num);
            if (leftMaxHeap.size() - rightMinHeap.size() &gt; 1 ){
                rightMinHeap.add(leftMaxHeap.poll());
            }
        }else {
            rightMinHeap.add(num);
            if (rightMinHeap.size() - leftMaxHeap.size() &gt; 1 ){
                leftMaxHeap.add(rightMinHeap.poll());
            }
        }
    }
    
    public double findMedian() {
        if ( (leftMaxHeap.size() + rightMinHeap.size())  % 2 == 0){
            return leftMaxHeap.peek() / 2.0 + rightMinHeap.peek() / 2.0;
        }else if (leftMaxHeap.size() &gt; rightMinHeap.size()){
            return leftMaxHeap.peek() * 1.0;
        }else{
            return rightMinHeap.peek() * 1.0;
        }
    }
}

/**
 * Your MedianFinder object will be instantiated and called as such:
 * MedianFinder obj = new MedianFinder();
 * obj.addNum(num);
 * double param_2 = obj.findMedian();
 */
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../hard-problems-no-explain/68.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../hard-problems-no-explain/68.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
